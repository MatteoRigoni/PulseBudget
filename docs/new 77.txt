# MODULO 1 â€“ HomeScreen UI con dati mock

1ï¸âƒ£  Crea HomeScreen:
â€¢ AppBar translucido con PeriodSelector (solo testo â€œMese correnteâ€ per ora).  
â€¢ BalanceCard vetrosa (180 dp) al centro:
    â€“ caption â€œSaldo del periodoâ€
    â€“ valore mock â‚¬ 0,00
    â€“ gradiente neutro grigio
    â€“ onTap: toast â€œAnalysis non ancora implementatoâ€
â€¢ Riga sotto: â€œ+ Entrate â‚¬0 â€¢ â€“ Uscite â‚¬0â€.
â€¢ Due Extended FAB centrati in basso:
    â€“ â€œâˆ’ Uscitaâ€ rosso
    â€“ â€œï¼‹ Entrataâ€ verde
    â€“ onPressed: toast â€œSheet non ancora implementataâ€.

2ï¸âƒ£  Crea helper `gradientByBalance(double)` che restituisce 3 gradienti (positivo, zero, negativo).

ğŸ‘‰  Mostra diff e attendi conferma.


# MODULO 2 â€“ Sheet nuova transazione (state in-memory)

ğŸ“„  Crea classe `Transaction` completa e `PaymentType` enum (se non esiste).

ğŸ—„ï¸  Provider Riverpod
`transactionsProvider` â†’ `StateNotifierProvider` con lista in-memory.

ğŸ†•  NewTransactionSheet
â€¢ Bottom-sheet 90 % altezza.
â€¢ Campi: amount (â‚¬ double, tastierino), date (DatePicker), description, paymentType (pill selector 4 scelte), category (dropdown placeholder).
â€¢ Bottoni Annulla / Salva.
â€¢ On Salva:
    â€“ costruisci `Transaction`
    â€“ aggiungi a `transactionsProvider`
    â€“ Navigator.pop()
    â€“ triggera animazione saldo (scale 0.95â†’1.0).

ğŸ   HomeScreen:
â€¢ Leggi lista transazioni dal provider.
â€¢ Calcola entrate/uscite/saldo e aggiorna UI + gradiente.

ğŸ‘‰  Mostra diff, attesa conferma.


# MODULO 3 â€“ Persistere su Firebase

1ï¸âƒ£  Configura Firebase (Spark) e inizializza in main().
2ï¸âƒ£  Creare `TransactionRepository` astratta + implementazione `FirestoreTransactionRepository`.
   â€¢ Campo aggiuntivo `descriptionLowercase`.
   â€¢ CRUD base (add, watchByPeriod).
   â€¢ Indicizzazione: indicami lâ€™index Firestore su `description_lowercase`.

3ï¸âƒ£  Modifica `transactionsProvider` per usare il repository Firestore (StreamProvider).

4ï¸âƒ£  NewTransactionSheet: salva su Firestore, non piÃ¹ in-memory.

ğŸ‘‰  Diff, conferma a mano prima di applicare.

# MODULO 4 â€“ Schermata Movimenti + search

ğŸ“„  MovementsScreen
â€¢ AppBar translucido con SearchBar â€œCerca movimentiâ€¦â€.
â€¢ Debounce 300 ms (RxDart) su query.
â€¢ Query Firestore like:
  where('description_lowercase', isGreaterThanOrEqualTo: q)
  .where('description_lowercase', isLessThanOrEqualTo: q + '\uf8ff')
â€¢ ListView TransactionCard:
    â€“ icona categoria
    â€“ descrizione (evidenzia match)
    â€“ importo Â± colorato
    â€“ data
    â€“ chip PaymentType
â€¢ Ordina: amount desc poi date desc.
â€¢ Empty-state grafica se lista vuota.

ğŸ‘‰  Diff + attesa conferma.

# MODULO 5 â€“ AnalysisSheet e CategoryDetail

1ï¸âƒ£  AnalysisSheet (showModalBottomSheet dal saldo)
   â€“ Stream transazioni periodo
   â€“ Raggruppa per categoria e ordina importo desc
   â€“ ListTile icona-categoria / nome / importo Â±
   â€“ onTap â†’ CategoryDetailPage

2ï¸âƒ£  CategoryDetailPage
   â€“ Pie-chart fl_chart
   â€“ ListView transazioni della categoria
   â€“ Pulsanti modifica/elimina (solo UI stub)

ğŸ‘‰  Diff, attendi conferma.

# MODULO 6 â€“ Ricorrenti

â€¢ Modello `RecurringRule` completo (Importo, CategoryId, PaymentType, RRule).
â€¢ `RecurringRuleRepository` Firestore.
â€¢ RecurringRulesPage: lista card + FAB â€œï¼‹â€.
â€¢ NewRecurringRuleSheet con picker frequenza (mensile default).
â€¢ Scheduler: quando salvi, genera transazioni future (no retroattivo).

ğŸ‘‰  Diff + conferma.

# MODULO 7 â€“ Categories CRUD

â€¢ Category model completo (id, name, iconCodePoint, colorHex, type income|expense).
â€¢ CategoryRepository Firestore, stream categories.
â€¢ CategoriesPage: Grid CategoryCard + FAB â€œï¼‹ Categoriaâ€.
â€¢ NewCategorySheet: IconPicker (fluentui_system_icons), ColorPicker (flex_color_picker), TextField name.
â€¢ Rifai dropdown categoria in NewTransactionSheet usando stream categorie.

ğŸ‘‰  Diff, conferma.

# MODULO 8 â€“ Test

1ï¸âƒ£  Unit-test
   â€“ TransactionRepository.searchMovements: verifica like-search.
   â€“ CategoryRepository CRUD.

2ï¸âƒ£  Widget-test
   â€“ HomeScreen: gradiente corretto per saldo +/0/âˆ’.
   â€“ MovementsScreen: digita â€œtagliandoâ€ â†’ verifica filtro.

Usa Firestore finto (cloud_firestore_mocks).

ğŸ‘‰  Diff, attesa conferma.

# MODULO 9 â€“ Import da CSV / PDF con Hard-replace

1ï¸âƒ£  Dipendenze
  file_picker:^6.0.0
  csv:^6.0.0
  pdf_text:^3.0.0  # solo se vuoi PDF subito

2ï¸âƒ£  Model
  enum ImportSource { csv, pdf, manual }

  Estendi Transaction con campo `importSource`.

3ï¸âƒ£  UI
  â€¢ Overflow menu in HomeScreen: voce â€œImporta estrattoâ€¦â€.
  â€¢ Dialog conferma: â€œSostituire tutte le transazioni di <mese/anno> con quelle importate?â€

4ï¸âƒ£  Flow
  a. FilePicker: accetta .csv e .pdf  
  b. ParserCsvService â†’ List<ImportedTx>  
     (se PDF, usa PdfParserService â†’ CSV-like list)  
  c. Mappa in Transaction (importSource = csv/pdf)  
  d. Repo: `deleteByMonth(year, month)` poi `batchInsert(list)`  
  e. Aggiorna providers, animazione saldo.

5ï¸âƒ£  Test
  â€¢ Unit-test CsvParserService con fixture CSV.  
  â€¢ Widget-test UI conferma + snackbar.

ğŸ‘‰  Mostra diff, attendi conferma.
