────────────────────────────────────────────────────────
🔰 MODULO 0 – Scaffold & fondazioni
────────────────────────────────────────────────────────
• Crea progetto Flutter 4 “pulse_budget”.
• Cartelle: lib/ui/, /model/, /provider/, /services/, /theme/.
• Pubspec:
    flutter_riverpod
    flutter_animate
    intl
    rxdart
    fl_chart
    flex_color_picker
    fluentui_system_icons
    file_picker
    csv
    pdf_text
• Theme Material 3 light/dark + dynamic-color (fallback teal).
• main.dart → HomeShell con BottomNav vuoto.
👉  Mostra diff e attendi conferma.

────────────────────────────────────────────────────────
🏠 MODULO 1 – HomeScreen UI + provider locale
────────────────────────────────────────────────────────
1. `transactionsProvider` ⇒ StateNotifierProvider<List<Transaction>> (vuota).

2. HomeScreen
   • TopAppBar “Pulse Budget” + settings.
   • SegmentedButton “Mese / Anno” (state locale).
   • Row chips mesi/anni scroll orizz.
   • BalanceCard 180 dp:
       – testo “Saldo”, valore mock € 0,00 con colore byBalance(0)
       – sotto “+ Entrate €0 • – Uscite €0”
       – tap → SnackBar “Analysis non implementato”.
   • TonalButton “Carica dati Carta” → SnackBar placeholder.
   • Due FAB circolari: verde + / rosso – → SnackBar “Sheet non implementata”.

3. Helper `Color gradientByBalance(double)` → verde | grigio | rosso.
👉  Diff, conferma.

────────────────────────────────────────────────────────
➕ MODULO 2 – NewTransactionSheet (in-memory)
────────────────────────────────────────────────────────
• model/transaction.dart + enum PaymentType { bancomat, carta, contanti, altro }.
• BottomSheet 90 %: amount, date, description, paymentType pills, category dropdown (dummy).
• On Salva:
    – crea Transaction
    – add() a transactionsProvider
    – Navigator.pop()
    – animate saldo (scale 0.95→1).
• HomeScreen rilegge provider e aggiorna saldo/entrate/uscite + gradiente.
👉  Diff, conferma.

────────────────────────────────────────────────────────
🏷️ MODULO 3 – Categories CRUD (locale)
────────────────────────────────────────────────────────
• model/category.dart (id, name, iconCodePoint, colorHex, type income|expense).
• `categoriesProvider` StateNotifierProvider<List<Category>> (mock preset).
• CategoriesPage grid + FAB “＋ Categoria”.
• NewCategorySheet: IconPicker + ColorPicker + name.
• Dropdown categoria in NewTransactionSheet ora legge dal provider.
👉  Diff, conferma.

────────────────────────────────────────────────────────
🔁 MODULO 4 – Ricorrenti (locale)
────────────────────────────────────────────────────────
• model/recurring_rule.dart (amount, categoryId, paymentType, rrule).
• `recurringRulesProvider` StateNotifierProvider<List<RecurringRule>>.
• RecurringRulesPage + FAB “＋”.
• NewRecurringRuleSheet con frequenza mensile default.
• Scheduler locale: genera transazioni future, non tocca mesi passati.
👉  Diff, conferma.

────────────────────────────────────────────────────────
────────────────────────────────────────────────────────
📊 MODULO 5 – AnalysisSheet & CategoryDetail (locale)
────────────────────────────────────────────────────────
• AnalysisSheet: aggrega transactionsProvider per categoria nel periodo, ordina desc.
• CategoryDetailPage: pie-chart (fl_chart) + lista transazioni, bottoni edit/del (stub).
👉  Diff, conferma.

────────────────────────────────────────────────────────
🔍 MODULO 6 – Movimenti + search (locale)
────────────────────────────────────────────────────────
• MovementsScreen:
    AppBar SearchBar “Cerca movimenti…”.
    Debounce 300 ms (RxDart).
    Filtra transactionsProvider by description.contains(query.lower()).
    ListView TransactionCard (icona, descrizione highlight, amount ±, data, chip PaymentType).
    Ordine: amount desc poi date desc.
    Empty-state se lista vuota.
👉  Diff, conferma.

────────────────────────────────────────────────────────
📥 MODULO 7 – Import CSV/PDF (replace mirato, locale)
────────────────────────────────────────────────────────
• Overflow menu “Importa estratto…”.
• Dialog 1: scegli paymentType (Bancomat | Carta).
• FilePicker .csv/.pdf.
• Parser → List<ImportedTx>.
• Sostituisci SOLO le uscite del mese con quel paymentType:
      newState = old.where(notSameMonthOrType) + importedList;
• SnackBar “Import completato: n movimenti”.
👉  Diff, conferma.

────────────────────────────────────────────────────────
🧪 MODULO 8 – Test (locale)
────────────────────────────────────────────────────────
• Unit-test: gradientByBalance(), CsvParser, filtro search.
• Widget-test: 
    – Home gradiente per +/0/–
    – Movements search “tagliando”.
👉  Diff, conferma.

────────────────────────────────────────────────────────
☁️ MODULO 9 – Persistenza Firebase (fase finale)
────────────────────────────────────────────────────────
1. Aggiungi firebase_core & cloud_firestore; Spark setup; init in main().
2. Repository astratti + Firestore implementation:
      TransactionRepository, CategoryRepository, RecurringRuleRepository.
3. Migra providers a StreamProvider (watchByPeriod, watchAll…).
4. NewTransactionSheet / Import / Ricorrenti ora usano repo.add / batch.
5. Crea indice su `description_lowercase` per like-search.
6. Aggiorna MovementsScreen a query Firestore.
7. Test con cloud_firestore_mocks.
👉  Diff, attendi conferma prima di applicare.